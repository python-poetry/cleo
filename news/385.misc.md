Switch to ruff formatter and add extra pre-commit checks
